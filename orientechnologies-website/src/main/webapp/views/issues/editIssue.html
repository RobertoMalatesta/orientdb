<div class="container-fluid edit-issue">
<div class="row vertical-align">
  <div class="col-md-9">
    <h3>{{ issue.title}}</h3>
  </div>
  <div class="col-md-3">
    <!--<div class="btn-group">-->
    <!--<a href="#/issues/new" class="btn btn-sm btn-default">Edit</a>-->
    <!--</div>-->

    <div class="btn-group">
      <a href="javascript:void(0)" ng-show="issue.number && isMember" ng-click="sync()" class="btn btn-sm btn-default">Sync
        Issue</a>
    </div>
    <div class="btn-group">
      <a href="#/issues/new" class="btn btn-sm btn-success">New Issue</a>
    </div>

  </div>
</div>
<div class="row">
  <div class="col-md-1 state">
    <h3><span class="label" ng-class="{ true : 'label-success',false : 'label-danger'}[issue.state == 'OPEN']">{{issue.state}}</span>
    </h3>
  </div>
  <div class="col-md-4">
    <b>{{issue.user.name}}</b> opened this issue {{ issue.createdAt | fromNow}}
  </div>
</div>
<div class="row">
  <div class="col-md-12">
    <hr>
  </div>
</div>
<div class="row">

  <div class="col-md-9">
    <div class="row">
      <div class="col-md-1">
        <avatar dim="50" user="issue.user"></avatar>
      </div>
      <div class="col-md-11">
        <div class="panel panel-default">

          <div class="panel-heading"><b>{{issue.user.name}}</b> commented {{ issue.createdAt | fromNow}}</div>
          <div class="panel-body">
            <div mkeditor ng-model="issue.body"></div>
          </div>
        </div>
      </div>

    </div>
    <div class="row events-list">
      <div ng-repeat="comment in comments">
        <div class="col-md-1">
          <div ng-if="!comment.event">
            <avatar dim="50" user="comment.user"></avatar>
          </div>

        </div>
        <div class="col-md-11">
          <div class="event" ng-if="!comment.event && $index == 0">

          </div>
          <div ng-if="!comment.event" class="panel panel-default">

            <div class="panel-heading"><b>{{comment.user.name}}</b> commented {{ comment.createdAt | fromNow}}</div>
            <div class="panel-body">
              <div mkeditor ng-show="comment.body" ng-model="comment.body"></div>
            </div>
          </div>
          <div class="event" ng-if="!comment.event">

          </div>
          <div class="event" ng-if="comment.event">

            <ng-include src="getEventTpl(comment.event)"></ng-include>
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-md-1">

      </div>
      <div class="col-md-11">
        <div class="panel panel-default">
          <div class="panel-heading">Leave a Comment</div>
          <div class="panel-body">
            <div class="" mkeditor ng-model="newComment.body"></div>


            <div class="btn-group pull-right">
              <button class="btn btn-sm btn-success" ng-click="comment()">
                Comment
              </button>
            </div>
            <div class="btn-group pull-right">
              <button class="btn btn-sm btn-default" ng-show="issue.state == 'OPEN'" ng-click="close()">
                Close
              </button>
              <button class="btn btn-sm btn-default" ng-show="issue.state == 'CLOSED'" ng-click="reopen()">
                Reopen Issue
              </button>
            </div>


          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-2 issue-sidebar">
    <div class="row">
      <div class="col-md-12">
        <button class="btn btn-transparent " ng-disabled="!isMember" data-placement="bottom-right"
                data-template="views/issues/popover/scopes.html" title="{{popover.title}}"
                data-content="{{popover.content}}" data-trigger="click" bs-popover>Area <i
          class="fa fa-gear pull-right"></i></button>
      </div>
      <div class="col-md-12 milestone">
        <span ng-show="issue.scope" class="label label-default">{{issue.scope.name}}</span>
      </div>
      <div class="col-md-12">
        <hr>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12">
        <button class="btn btn-transparent " ng-disabled="!isMember" data-placement="bottom-right"
                data-template="views/issues/popover/priorities.html" title="{{popover.title}}"
                data-content="{{popover.content}}" data-trigger="click" bs-popover>Priority <i
          class="fa fa-gear pull-right"></i></button>
      </div>
      <div class="col-md-12 milestone">
        <span ng-show="issue.priority" style="background-color: #{{issue.priority.color}}" class="label label-primary">{{issue.priority.name}}</span>
      </div>
      <div class="col-md-12">
        <hr>
      </div>
    </div>
    <div class="row issue-assignee">
      <div class="col-md-12">
        <button class="btn btn-transparent" ng-disabled="!isMember" data-placement="bottom-right"
                data-template="views/issues/popover/assignee.html" title="{{popover.title}}"
                data-content="{{popover.content}}" data-trigger="click" bs-popover>Assignee <i
          class="fa fa-gear pull-right"></i>
        </button>
      </div>
      <div class="col-md-12">
        <div ng-if="issue.assignee">
          <avatar class="issue-assignee-avatar" name="true" dim="20" user="issue.assignee">
          </avatar>
        </div>
      </div>

      <div class="col-md-12">
        <hr>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12">
        <button ng-show="issue.environment" class="btn btn-transparent" ng-disabled="false" data-placement="left"
                data-template="views/issues/popover/environmentEdit.html"
                title="{{popover.title}}"
                data-content="{{popover.content}}"
                data-trigger="click"
                bs-popover="issue">Environment <i
          class="fa fa-gear pull-right"></i></button>
        <button ng-hide="issue.environment" class="btn btn-transparent" ng-disabled="false" data-placement="left"
                data-template="views/issues/popover/environmentSelect.html"
                title="{{popover.title}}"
                data-content="{{popover.content}}"
                data-trigger="click"
                bs-popover="issue">Environment <i
          class="fa fa-gear pull-right"></i></button>
      </div>
      <div class="col-md-12 milestone">
        <span ng-show="issue.environment" data-placement="top"
              data-template="views/issues/popover/environment.html" title="{{popover.title}}"
              data-content="{{popover.content}}" data-trigger="hover" bs-popover="issue.environment"
              class="label label-primary">{{issue.environment.name}}</span>
      </div>
      <div class="col-md-12">
        <hr>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12">
        <button class="btn btn-transparent" ng-disabled="!isMember" class="btn btn-lg btn-primary"
                data-placement="bottom-right"
                data-template="views/issues/popover/labels.html"
                title="{{popover.title}}" data-content="{{popover.content}}" data-trigger="click" bs-popover>Labels <i
          class="fa fa-gear pull-right"></i></button>
      </div>
      <div class="col-md-12">
        <div class="row">
          <div class="col-md-12 issue-label" ng-repeat="label in issue.labels">
            <span class="label" style="background-color: #{{label.color}}">{{label.name}}</span>
          </div>
        </div>
      </div>
      <div class="col-md-12">
        <hr>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12">
        <button class="btn btn-transparent" ng-disabled="!isMember" data-placement="bottom-right"
                data-template="views/issues/popover/versions.html" title="{{popover.title}}"
                data-content="{{popover.content}}" data-trigger="click" bs-popover>Version <i
          class="fa fa-gear pull-right"></i></button>
      </div>
      <div class="col-md-12 milestone">
        <span ng-show="issue.version" class="label label-primary">{{issue.version.title}}</span>
      </div>
      <div class="col-md-12">
        <hr>
      </div>

    </div>
    <div class="row">
      <div class="col-md-12">
        <button class="btn btn-transparent " ng-disabled="!isMember" data-placement="bottom-right"
                data-template="views/issues/popover/milestones.html" title="{{popover.title}}"
                data-content="{{popover.content}}" data-trigger="click" bs-popover>Milestone <i
          class="fa fa-gear pull-right"></i></button>
      </div>
      <div class="col-md-12 milestone">
        <span ng-show="issue.milestone" class="label label-primary">{{issue.milestone.title}}</span>
      </div>
      <div class="col-md-12">
        <hr>
      </div>

    </div>

  </div>
</div>
</div>
